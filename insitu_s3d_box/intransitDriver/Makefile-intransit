SHELL   = /bin/sh
CC = CC 
FTN = ftn
INCLUDES=-I. \
	-I../ \
	-I../statistics \
    -I../visualization \
    -I../visualization/hpgv \
    -I../topology \
    -I/ccs/proj/e2e/habbasi/s3dinsitu/topology/include/ \
    -I/ccs/proj/e2e/habbasi/s3dinsitu/dataspaces/include/ \
    -I/opt/cray/rca/default/include \
    -I/opt/cray-hss-devel/6.0.0/include     \
    -I/opt/cray/krca/1.0.0-2.0400.29855.4.28.gem/include 

CFLAGS = -DS3D_BOX_INTRANSIT

PMI_CFLAGS = $(shell pkg-config --cflags cray-pmi)
PMI_LIBS = $(shell pkg-config --libs cray-pmi)
UGNI_CFLAGS = $(shell pkg-config --cflags cray-ugni)
UGNI_LIBS = $(shell pkg-config --libs cray-ugni)
LIBS=-L/ccs/proj/e2e/habbasi/s3dinsitu/dataspaces/lib/ -ldspace ${PMI_LIBS} ${UGNI_LIBS} \
     -L/opt/cray/rca/default/lib64 -lrca ../visualization/libs3d_box_viz_intransit.a ../visualization/hpgv/libhpgv.a \
     -L/opt/cray/rca/default/lib64 -lrca \
     -L/ccs/proj/e2e/habbasi/s3dinsitu/topology/lib/ -lparallelMT -lStreamingTopology -lStreamingParser -lStatistics -lTopologyFileParser -lFlexArray

CFLAGS += -g ${UGNI_CFLAGS} ${PMI_CLFASG} -DHYBRID

SRC2 = intransit_driver.cpp \
	../statistics/intransitDescriptiveStats.cpp \
	../topology/intransitTopology.cpp

OBJ2 = $(SRC2:.cpp=.o)

OUT2 = ./intransit_driver

default: $(OUT2) 

.cpp.o:
	$(CC) $(INCLUDES) $(CFLAGS) -c $< -o $@

$(OUT2): $(OBJ2)
	$(CC) $(CFLAGS) $(INCLUDES) $(OBJ2) -o $(OUT2) $(LIBS)

clean:
	rm -f $(OUT2) $(OBJ2)


