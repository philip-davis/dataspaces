C                                                                      C
C----------------------------------------------------------------------C
C                                                                      C
      SUBROUTINE STIF(VL, RF, RB, DIFF, DT, C)
      USE chemkin_m, only : MAXVL
      IMPLICIT DOUBLE PRECISION (A-H, O-Z), INTEGER (I-N)
      DIMENSION RF(MAXVL,*),RB(MAXVL,*),DIFF(MAXVL,*),C(MAXVL,*)
        INTEGER VL
CCCC      DATA TC/2E+008/
       TC=2.0D0/DT         !esr24Aug09
C Previously TC was a constant and this sometimes gave problems for dt less than 1ns.
C
      DO I=1,VL
C
C
C     H
      DDOT=+RF(I,1)+RB(I,2)+RB(I,3)+RB(I,5)+RB(I,5)+RF(I,7)+RF(I,8)
     *+RF(I,9)+RF(I,10)+RF(I,11)+RF(I,17)+RF(I,18)+RB(I,25)+RB(I,26)
     *+RF(I,28)+RB(I,31)+RB(I,32)+RB(I,36)+RF(I,38)+RB(I,44)+RF(I,49)
     *+RF(I,50)+RB(I,55)+RF(I,56)+RF(I,57)+RB(I,64)+RF(I,65)+RB(I,72)
     *+RB(I,77)+RB(I,78)+RF(I,79)+RF(I,80)+RF(I,86)+RF(I,87)+RB(I,92)
     *+RF(I,94)+RF(I,95)+RF(I,96)+RF(I,103)+RF(I,109)+RF(I,112)
     *+RB(I,113)+RB(I,114)+RB(I,115)+RB(I,124)+RB(I,125)+RB(I,126)
     *+RB(I,127)+RF(I,133)+RB(I,142)+RF(I,147)+RB(I,164)+RB(I,169)
     *+RF(I,171)+RB(I,171)+RF(I,172)
      TINV=DDOT/C(I,1)
      IF (TINV .GT. TC) THEN
      CDOT=+RB(I,1)+RF(I,2)+RF(I,3)+RF(I,5)+RF(I,5)+RB(I,7)+RB(I,8)
     *+RB(I,9)+RB(I,10)+RB(I,11)+RB(I,17)+RB(I,18)+RF(I,25)+RF(I,26)
     *+RB(I,28)+RF(I,31)+RF(I,32)+RF(I,36)+RB(I,38)+RF(I,44)+RB(I,49)
     *+RB(I,50)+RF(I,55)+RB(I,56)+RB(I,57)+RF(I,64)+RB(I,65)+RF(I,72)
     *+RF(I,77)+RF(I,78)+RB(I,79)+RB(I,80)+RB(I,86)+RB(I,87)+RF(I,92)
     *+RB(I,94)+RB(I,95)+RB(I,96)+RB(I,103)+RB(I,109)+RB(I,112)
     *+RF(I,113)+RF(I,114)+RF(I,115)+RF(I,124)+RF(I,125)+RF(I,126)
     *+RF(I,127)+RB(I,133)+RF(I,142)+RB(I,147)+RF(I,164)+RF(I,169)
     *+RB(I,171)+RF(I,171)+RB(I,172)
      C0=C(I,1)*(CDOT+DIFF(I,1)/1.00796998)/DDOT
      C0=C(I,1)*(CDOT+DIFF(I,1)/1.00796998+(C(I,1)-C0)/DT)/DDOT
      R=C0/C(I,1)
      RF(I,1)=RF(I,1)*R
      RB(I,2)=RB(I,2)*R
      RB(I,3)=RB(I,3)*R
      RB(I,5)=RB(I,5)*R
      RB(I,5)=RB(I,5)*R
      RF(I,7)=RF(I,7)*R
      RF(I,8)=RF(I,8)*R
      RF(I,9)=RF(I,9)*R
      RF(I,10)=RF(I,10)*R
      RF(I,11)=RF(I,11)*R
      RF(I,17)=RF(I,17)*R
      RF(I,18)=RF(I,18)*R
      RB(I,25)=RB(I,25)*R
      RB(I,26)=RB(I,26)*R
      RF(I,28)=RF(I,28)*R
      RB(I,31)=RB(I,31)*R
      RB(I,32)=RB(I,32)*R
      RB(I,36)=RB(I,36)*R
      RF(I,38)=RF(I,38)*R
      RB(I,44)=RB(I,44)*R
      RF(I,49)=RF(I,49)*R
      RF(I,50)=RF(I,50)*R
      RB(I,55)=RB(I,55)*R
      RF(I,56)=RF(I,56)*R
      RF(I,57)=RF(I,57)*R
      RB(I,64)=RB(I,64)*R
      RF(I,65)=RF(I,65)*R
      RB(I,72)=RB(I,72)*R
      RB(I,77)=RB(I,77)*R
      RB(I,78)=RB(I,78)*R
      RF(I,79)=RF(I,79)*R
      RF(I,80)=RF(I,80)*R
      RF(I,86)=RF(I,86)*R
      RF(I,87)=RF(I,87)*R
      RB(I,92)=RB(I,92)*R
      RF(I,94)=RF(I,94)*R
      RF(I,95)=RF(I,95)*R
      RF(I,96)=RF(I,96)*R
      RF(I,103)=RF(I,103)*R
      RF(I,109)=RF(I,109)*R
      RF(I,112)=RF(I,112)*R
      RB(I,113)=RB(I,113)*R
      RB(I,114)=RB(I,114)*R
      RB(I,115)=RB(I,115)*R
      RB(I,124)=RB(I,124)*R
      RB(I,125)=RB(I,125)*R
      RB(I,126)=RB(I,126)*R
      RB(I,127)=RB(I,127)*R
      RF(I,133)=RF(I,133)*R
      RB(I,142)=RB(I,142)*R
      RF(I,147)=RF(I,147)*R
      RB(I,164)=RB(I,164)*R
      RB(I,169)=RB(I,169)*R
      RF(I,171)=RF(I,171)*R
      RB(I,171)=RB(I,171)*R
      RF(I,172)=RF(I,172)*R
      ENDIF
C
C     H2
      DDOT=+RF(I,2)+RF(I,3)+RF(I,5)+RB(I,10)+RB(I,18)+RB(I,28)+RB(I,33)
     *+RB(I,37)+RB(I,38)+RB(I,50)+RB(I,56)+RB(I,80)+RB(I,87)+RB(I,93)
     *+RB(I,96)+RB(I,103)+RF(I,115)+RB(I,118)+RB(I,123)+RF(I,126)
     *+RB(I,133)+RB(I,147)+RB(I,167)+RB(I,171)+RB(I,172)
      TINV=DDOT/C(I,2)
      IF (TINV .GT. TC) THEN
      CDOT=+RB(I,2)+RB(I,3)+RB(I,5)+RF(I,10)+RF(I,18)+RF(I,28)+RF(I,33)
     *+RF(I,37)+RF(I,38)+RF(I,50)+RF(I,56)+RF(I,80)+RF(I,87)+RF(I,93)
     *+RF(I,96)+RF(I,103)+RB(I,115)+RF(I,118)+RF(I,123)+RB(I,126)
     *+RF(I,133)+RF(I,147)+RF(I,167)+RF(I,171)+RF(I,172)
      C0=C(I,2)*(CDOT+DIFF(I,2)/2.01593995)/DDOT
      C0=C(I,2)*(CDOT+DIFF(I,2)/2.01593995+(C(I,2)-C0)/DT)/DDOT
      R=C0/C(I,2)
      RF(I,2)=RF(I,2)*R
      RF(I,3)=RF(I,3)*R
      RF(I,5)=RF(I,5)*R
      RB(I,10)=RB(I,10)*R
      RB(I,18)=RB(I,18)*R
      RB(I,28)=RB(I,28)*R
      RB(I,33)=RB(I,33)*R
      RB(I,37)=RB(I,37)*R
      RB(I,38)=RB(I,38)*R
      RB(I,50)=RB(I,50)*R
      RB(I,56)=RB(I,56)*R
      RB(I,80)=RB(I,80)*R
      RB(I,87)=RB(I,87)*R
      RB(I,93)=RB(I,93)*R
      RB(I,96)=RB(I,96)*R
      RB(I,103)=RB(I,103)*R
      RF(I,115)=RF(I,115)*R
      RB(I,118)=RB(I,118)*R
      RB(I,123)=RB(I,123)*R
      RF(I,126)=RF(I,126)*R
      RB(I,133)=RB(I,133)*R
      RB(I,147)=RB(I,147)*R
      RB(I,167)=RB(I,167)*R
      RB(I,171)=RB(I,171)*R
      RB(I,172)=RB(I,172)*R
      ENDIF
C
C     CH3
      DDOT=+RF(I,34)+RF(I,43)+RF(I,44)+RF(I,45)+RF(I,46)+RF(I,47)
     *+RF(I,48)+RF(I,48)+RF(I,49)+RB(I,50)+RB(I,51)+RB(I,52)+RF(I,53)
     *+RB(I,54)+RB(I,57)+RB(I,65)+RB(I,71)+RF(I,72)+RF(I,72)+RB(I,73)
     *+RB(I,73)+RB(I,74)+RB(I,74)+RF(I,75)+RF(I,76)+RF(I,77)+RF(I,78)
     *+RF(I,85)+RB(I,88)+RF(I,98)+RB(I,99)+RF(I,105)+RB(I,111)+RB(I,112)
     *+RB(I,115)+RB(I,126)+RB(I,130)+RB(I,131)+RF(I,134)+RB(I,138)
     *+RF(I,148)+RB(I,150)+RF(I,173)
      TINV=DDOT/C(I,3)
      IF (TINV .GT. TC) THEN
      CDOT=+RB(I,34)+RB(I,43)+RB(I,44)+RB(I,45)+RB(I,46)+RB(I,47)
     *+RB(I,48)+RB(I,48)+RB(I,49)+RF(I,50)+RF(I,51)+RF(I,52)+RB(I,53)
     *+RF(I,54)+RF(I,57)+RF(I,65)+RF(I,71)+RB(I,72)+RB(I,72)+RF(I,73)
     *+RF(I,73)+RF(I,74)+RF(I,74)+RB(I,75)+RB(I,76)+RB(I,77)+RB(I,78)
     *+RB(I,85)+RF(I,88)+RB(I,98)+RF(I,99)+RB(I,105)+RF(I,111)+RF(I,112)
     *+RF(I,115)+RF(I,126)+RF(I,130)+RF(I,131)+RB(I,134)+RF(I,138)
     *+RB(I,148)+RF(I,150)+RB(I,173)
      C0=C(I,3)*(CDOT+DIFF(I,3)/15.03506029)/DDOT
      C0=C(I,3)*(CDOT+DIFF(I,3)/15.03506029+(C(I,3)-C0)/DT)/DDOT
      R=C0/C(I,3)
      RF(I,34)=RF(I,34)*R
      RF(I,43)=RF(I,43)*R
      RF(I,44)=RF(I,44)*R
      RF(I,45)=RF(I,45)*R
      RF(I,46)=RF(I,46)*R
      RF(I,47)=RF(I,47)*R
      RF(I,48)=RF(I,48)*R
      RF(I,48)=RF(I,48)*R
      RF(I,49)=RF(I,49)*R
      RB(I,50)=RB(I,50)*R
      RB(I,51)=RB(I,51)*R
      RB(I,52)=RB(I,52)*R
      RF(I,53)=RF(I,53)*R
      RB(I,54)=RB(I,54)*R
      RB(I,57)=RB(I,57)*R
      RB(I,65)=RB(I,65)*R
      RB(I,71)=RB(I,71)*R
      RF(I,72)=RF(I,72)*R
      RF(I,72)=RF(I,72)*R
      RB(I,73)=RB(I,73)*R
      RB(I,73)=RB(I,73)*R
      RB(I,74)=RB(I,74)*R
      RB(I,74)=RB(I,74)*R
      RF(I,75)=RF(I,75)*R
      RF(I,76)=RF(I,76)*R
      RF(I,77)=RF(I,77)*R
      RF(I,78)=RF(I,78)*R
      RF(I,85)=RF(I,85)*R
      RB(I,88)=RB(I,88)*R
      RF(I,98)=RF(I,98)*R
      RB(I,99)=RB(I,99)*R
      RF(I,105)=RF(I,105)*R
      RB(I,111)=RB(I,111)*R
      RB(I,112)=RB(I,112)*R
      RB(I,115)=RB(I,115)*R
      RB(I,126)=RB(I,126)*R
      RB(I,130)=RB(I,130)*R
      RB(I,131)=RB(I,131)*R
      RF(I,134)=RF(I,134)*R
      RB(I,138)=RB(I,138)*R
      RF(I,148)=RF(I,148)*R
      RB(I,150)=RB(I,150)*R
      RF(I,173)=RF(I,173)*R
      ENDIF
C
C     O
      DDOT=+RB(I,1)+RF(I,2)+RF(I,4)+RF(I,6)+RF(I,6)+RF(I,7)+RF(I,12)
     *+RF(I,19)+RF(I,22)+RB(I,23)+RF(I,29)+RF(I,31)+RF(I,39)+RF(I,44)
     *+RB(I,45)+RF(I,51)+RF(I,58)+RF(I,66)+RF(I,81)+RF(I,88)+RF(I,92)
     *+RF(I,99)+RF(I,101)+RF(I,110)+RF(I,113)+RF(I,123)+RF(I,124)
     *+RF(I,135)+RF(I,146)+RF(I,175)
      TINV=DDOT/C(I,4)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,1)+RB(I,2)+RB(I,4)+RB(I,6)+RB(I,6)+RB(I,7)+RB(I,12)
     *+RB(I,19)+RB(I,22)+RF(I,23)+RB(I,29)+RB(I,31)+RB(I,39)+RB(I,44)
     *+RF(I,45)+RB(I,51)+RB(I,58)+RB(I,66)+RB(I,81)+RB(I,88)+RB(I,92)
     *+RB(I,99)+RB(I,101)+RB(I,110)+RB(I,113)+RB(I,123)+RB(I,124)
     *+RB(I,135)+RB(I,146)+RB(I,175)
      C0=C(I,4)*(CDOT+DIFF(I,4)/15.99940014)/DDOT
      C0=C(I,4)*(CDOT+DIFF(I,4)/15.99940014+(C(I,4)-C0)/DT)/DDOT
      R=C0/C(I,4)
      RB(I,1)=RB(I,1)*R
      RF(I,2)=RF(I,2)*R
      RF(I,4)=RF(I,4)*R
      RF(I,6)=RF(I,6)*R
      RF(I,6)=RF(I,6)*R
      RF(I,7)=RF(I,7)*R
      RF(I,12)=RF(I,12)*R
      RF(I,19)=RF(I,19)*R
      RF(I,22)=RF(I,22)*R
      RB(I,23)=RB(I,23)*R
      RF(I,29)=RF(I,29)*R
      RF(I,31)=RF(I,31)*R
      RF(I,39)=RF(I,39)*R
      RF(I,44)=RF(I,44)*R
      RB(I,45)=RB(I,45)*R
      RF(I,51)=RF(I,51)*R
      RF(I,58)=RF(I,58)*R
      RF(I,66)=RF(I,66)*R
      RF(I,81)=RF(I,81)*R
      RF(I,88)=RF(I,88)*R
      RF(I,92)=RF(I,92)*R
      RF(I,99)=RF(I,99)*R
      RF(I,101)=RF(I,101)*R
      RF(I,110)=RF(I,110)*R
      RF(I,113)=RF(I,113)*R
      RF(I,123)=RF(I,123)*R
      RF(I,124)=RF(I,124)*R
      RF(I,135)=RF(I,135)*R
      RF(I,146)=RF(I,146)*R
      RF(I,175)=RF(I,175)*R
      ENDIF
C
C     CH4
      DDOT=+RB(I,34)+RB(I,43)+RB(I,49)+RF(I,50)+RF(I,51)+RF(I,52)
     *+RB(I,53)+RF(I,54)+RF(I,73)+RF(I,74)+RB(I,85)+RB(I,98)+RB(I,105)
     *+RB(I,134)+RB(I,148)+RB(I,173)
      TINV=DDOT/C(I,5)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,34)+RF(I,43)+RF(I,49)+RB(I,50)+RB(I,51)+RB(I,52)
     *+RF(I,53)+RB(I,54)+RB(I,73)+RB(I,74)+RF(I,85)+RF(I,98)+RF(I,105)
     *+RF(I,134)+RF(I,148)+RF(I,173)
      C0=C(I,5)*(CDOT+DIFF(I,5)/16.04303026)/DDOT
      C0=C(I,5)*(CDOT+DIFF(I,5)/16.04303026+(C(I,5)-C0)/DT)/DDOT
      R=C0/C(I,5)
      RB(I,34)=RB(I,34)*R
      RB(I,43)=RB(I,43)*R
      RB(I,49)=RB(I,49)*R
      RF(I,50)=RF(I,50)*R
      RF(I,51)=RF(I,51)*R
      RF(I,52)=RF(I,52)*R
      RB(I,53)=RB(I,53)*R
      RF(I,54)=RF(I,54)*R
      RF(I,73)=RF(I,73)*R
      RF(I,74)=RF(I,74)*R
      RB(I,85)=RB(I,85)*R
      RB(I,98)=RB(I,98)*R
      RB(I,105)=RB(I,105)*R
      RB(I,134)=RB(I,134)*R
      RB(I,148)=RB(I,148)*R
      RB(I,173)=RB(I,173)*R
      ENDIF
C
C     OH
      DDOT=+RB(I,1)+RB(I,2)+RF(I,3)+RB(I,4)+RB(I,4)+RB(I,7)+RF(I,8)
     *+RB(I,11)+RB(I,11)+RB(I,12)+RF(I,13)+RB(I,16)+RB(I,16)+RB(I,17)
     *+RB(I,19)+RF(I,20)+RF(I,21)+RB(I,24)+RF(I,25)+RB(I,29)+RF(I,30)
     *+RB(I,32)+RB(I,39)+RF(I,40)+RB(I,46)+RB(I,47)+RB(I,51)+RF(I,52)
     *+RB(I,57)+RB(I,58)+RF(I,59)+RB(I,65)+RB(I,66)+RF(I,67)+RF(I,75)
     *+RF(I,76)+RB(I,81)+RF(I,82)+RF(I,97)+RF(I,100)+RB(I,101)+RF(I,111)
     *+RF(I,114)+RB(I,116)+RB(I,117)+RF(I,125)+RB(I,127)+RF(I,132)
     *+RB(I,135)+RB(I,141)+RF(I,144)+RB(I,146)+RB(I,157)+RB(I,159)
     *+RB(I,160)+RF(I,165)+RB(I,168)+RF(I,169)+RF(I,170)+RB(I,170)
     *+RB(I,172)+RB(I,173)+RB(I,174)+RB(I,175)+RB(I,175)
      TINV=DDOT/C(I,6)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,1)+RF(I,2)+RB(I,3)+RF(I,4)+RF(I,4)+RF(I,7)+RB(I,8)
     *+RF(I,11)+RF(I,11)+RF(I,12)+RB(I,13)+RF(I,16)+RF(I,16)+RF(I,17)
     *+RF(I,19)+RB(I,20)+RB(I,21)+RF(I,24)+RB(I,25)+RF(I,29)+RB(I,30)
     *+RF(I,32)+RF(I,39)+RB(I,40)+RF(I,46)+RF(I,47)+RF(I,51)+RB(I,52)
     *+RF(I,57)+RF(I,58)+RB(I,59)+RF(I,65)+RF(I,66)+RB(I,67)+RB(I,75)
     *+RB(I,76)+RF(I,81)+RB(I,82)+RB(I,97)+RB(I,100)+RF(I,101)+RB(I,111)
     *+RB(I,114)+RF(I,116)+RF(I,117)+RB(I,125)+RF(I,127)+RB(I,132)
     *+RF(I,135)+RF(I,141)+RB(I,144)+RF(I,146)+RF(I,157)+RF(I,159)
     *+RF(I,160)+RB(I,165)+RF(I,168)+RB(I,169)+RB(I,170)+RF(I,170)
     *+RF(I,172)+RF(I,173)+RF(I,174)+RF(I,175)+RF(I,175)
      C0=C(I,6)*(CDOT+DIFF(I,6)/17.00737011)/DDOT
      C0=C(I,6)*(CDOT+DIFF(I,6)/17.00737011+(C(I,6)-C0)/DT)/DDOT
      R=C0/C(I,6)
      RB(I,1)=RB(I,1)*R
      RB(I,2)=RB(I,2)*R
      RF(I,3)=RF(I,3)*R
      RB(I,4)=RB(I,4)*R
      RB(I,4)=RB(I,4)*R
      RB(I,7)=RB(I,7)*R
      RF(I,8)=RF(I,8)*R
      RB(I,11)=RB(I,11)*R
      RB(I,11)=RB(I,11)*R
      RB(I,12)=RB(I,12)*R
      RF(I,13)=RF(I,13)*R
      RB(I,16)=RB(I,16)*R
      RB(I,16)=RB(I,16)*R
      RB(I,17)=RB(I,17)*R
      RB(I,19)=RB(I,19)*R
      RF(I,20)=RF(I,20)*R
      RF(I,21)=RF(I,21)*R
      RB(I,24)=RB(I,24)*R
      RF(I,25)=RF(I,25)*R
      RB(I,29)=RB(I,29)*R
      RF(I,30)=RF(I,30)*R
      RB(I,32)=RB(I,32)*R
      RB(I,39)=RB(I,39)*R
      RF(I,40)=RF(I,40)*R
      RB(I,46)=RB(I,46)*R
      RB(I,47)=RB(I,47)*R
      RB(I,51)=RB(I,51)*R
      RF(I,52)=RF(I,52)*R
      RB(I,57)=RB(I,57)*R
      RB(I,58)=RB(I,58)*R
      RF(I,59)=RF(I,59)*R
      RB(I,65)=RB(I,65)*R
      RB(I,66)=RB(I,66)*R
      RF(I,67)=RF(I,67)*R
      RF(I,75)=RF(I,75)*R
      RF(I,76)=RF(I,76)*R
      RB(I,81)=RB(I,81)*R
      RF(I,82)=RF(I,82)*R
      RF(I,97)=RF(I,97)*R
      RF(I,100)=RF(I,100)*R
      RB(I,101)=RB(I,101)*R
      RF(I,111)=RF(I,111)*R
      RF(I,114)=RF(I,114)*R
      RB(I,116)=RB(I,116)*R
      RB(I,117)=RB(I,117)*R
      RF(I,125)=RF(I,125)*R
      RB(I,127)=RB(I,127)*R
      RF(I,132)=RF(I,132)*R
      RB(I,135)=RB(I,135)*R
      RB(I,141)=RB(I,141)*R
      RF(I,144)=RF(I,144)*R
      RB(I,146)=RB(I,146)*R
      RB(I,157)=RB(I,157)*R
      RB(I,159)=RB(I,159)*R
      RB(I,160)=RB(I,160)*R
      RF(I,165)=RF(I,165)*R
      RB(I,168)=RB(I,168)*R
      RF(I,169)=RF(I,169)*R
      RF(I,170)=RF(I,170)*R
      RB(I,170)=RB(I,170)*R
      RB(I,172)=RB(I,172)*R
      RB(I,173)=RB(I,173)*R
      RB(I,174)=RB(I,174)*R
      RB(I,175)=RB(I,175)*R
      RB(I,175)=RB(I,175)*R
      ENDIF
C
C     C2H4
      DDOT=+RB(I,77)+RB(I,78)+RB(I,87)+RB(I,89)+RB(I,90)+RF(I,93)
     *+RF(I,94)+RB(I,95)+RF(I,96)+RF(I,97)+RF(I,98)+RF(I,99)+RF(I,101)
     *+RF(I,102)+RB(I,104)+RB(I,106)
      TINV=DDOT/C(I,10)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,77)+RF(I,78)+RF(I,87)+RF(I,89)+RF(I,90)+RB(I,93)
     *+RB(I,94)+RF(I,95)+RB(I,96)+RB(I,97)+RB(I,98)+RB(I,99)+RB(I,101)
     *+RB(I,102)+RF(I,104)+RF(I,106)
      C0=C(I,10)*(CDOT+DIFF(I,10)/28.05418062)/DDOT
      C0=C(I,10)*(CDOT+DIFF(I,10)/28.05418062+(C(I,10)-C0)/DT)/DDOT
      R=C0/C(I,10)
      RB(I,77)=RB(I,77)*R
      RB(I,78)=RB(I,78)*R
      RB(I,87)=RB(I,87)*R
      RB(I,89)=RB(I,89)*R
      RB(I,90)=RB(I,90)*R
      RF(I,93)=RF(I,93)*R
      RF(I,94)=RF(I,94)*R
      RB(I,95)=RB(I,95)*R
      RF(I,96)=RF(I,96)*R
      RF(I,97)=RF(I,97)*R
      RF(I,98)=RF(I,98)*R
      RF(I,99)=RF(I,99)*R
      RF(I,101)=RF(I,101)*R
      RF(I,102)=RF(I,102)*R
      RB(I,104)=RB(I,104)*R
      RB(I,106)=RB(I,106)*R
      ENDIF
C
C     C2H5
      DDOT=+RB(I,72)+RB(I,80)+RB(I,81)+RB(I,82)+RB(I,83)+RB(I,84)
     *+RB(I,85)+RF(I,86)+RF(I,87)+RF(I,88)+RF(I,89)+RF(I,90)+RF(I,90)
     *+RF(I,91)+RF(I,92)+RB(I,94)
      TINV=DDOT/C(I,11)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,72)+RF(I,80)+RF(I,81)+RF(I,82)+RF(I,83)+RF(I,84)
     *+RF(I,85)+RB(I,86)+RB(I,87)+RB(I,88)+RB(I,89)+RB(I,90)+RB(I,90)
     *+RB(I,91)+RB(I,92)+RF(I,94)
      C0=C(I,11)*(CDOT+DIFF(I,11)/29.06215060)/DDOT
      C0=C(I,11)*(CDOT+DIFF(I,11)/29.06215060+(C(I,11)-C0)/DT)/DDOT
      R=C0/C(I,11)
      RB(I,72)=RB(I,72)*R
      RB(I,80)=RB(I,80)*R
      RB(I,81)=RB(I,81)*R
      RB(I,82)=RB(I,82)*R
      RB(I,83)=RB(I,83)*R
      RB(I,84)=RB(I,84)*R
      RB(I,85)=RB(I,85)*R
      RF(I,86)=RF(I,86)*R
      RF(I,87)=RF(I,87)*R
      RF(I,88)=RF(I,88)*R
      RF(I,89)=RF(I,89)*R
      RF(I,90)=RF(I,90)*R
      RF(I,90)=RF(I,90)*R
      RF(I,91)=RF(I,91)*R
      RF(I,92)=RF(I,92)*R
      RB(I,94)=RB(I,94)*R
      ENDIF
C
C     CH2O
      DDOT=+RB(I,35)+RF(I,36)+RF(I,37)+RF(I,38)+RF(I,39)+RF(I,40)
     *+RF(I,41)+RF(I,42)+RF(I,43)+RB(I,44)+RB(I,46)+RB(I,55)+RB(I,56)
     *+RB(I,58)+RB(I,59)+RB(I,60)+RB(I,61)+RB(I,62)+RB(I,63)+RB(I,63)
     *+RB(I,64)+RB(I,66)+RB(I,67)+RB(I,68)+RB(I,69)+RB(I,70)+RB(I,88)
     *+RB(I,107)+RB(I,114)+RB(I,117)+RB(I,125)+RB(I,129)+RB(I,138)
     *+RB(I,139)+RF(I,140)+RB(I,154)+RB(I,157)+RB(I,157)+RF(I,165)
      TINV=DDOT/C(I,12)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,35)+RB(I,36)+RB(I,37)+RB(I,38)+RB(I,39)+RB(I,40)
     *+RB(I,41)+RB(I,42)+RB(I,43)+RF(I,44)+RF(I,46)+RF(I,55)+RF(I,56)
     *+RF(I,58)+RF(I,59)+RF(I,60)+RF(I,61)+RF(I,62)+RF(I,63)+RF(I,63)
     *+RF(I,64)+RF(I,66)+RF(I,67)+RF(I,68)+RF(I,69)+RF(I,70)+RF(I,88)
     *+RF(I,107)+RF(I,114)+RF(I,117)+RF(I,125)+RF(I,129)+RF(I,138)
     *+RF(I,139)+RB(I,140)+RF(I,154)+RF(I,157)+RF(I,157)+RB(I,165)
      C0=C(I,12)*(CDOT+DIFF(I,12)/30.02649045)/DDOT
      C0=C(I,12)*(CDOT+DIFF(I,12)/30.02649045+(C(I,12)-C0)/DT)/DDOT
      R=C0/C(I,12)
      RB(I,35)=RB(I,35)*R
      RF(I,36)=RF(I,36)*R
      RF(I,37)=RF(I,37)*R
      RF(I,38)=RF(I,38)*R
      RF(I,39)=RF(I,39)*R
      RF(I,40)=RF(I,40)*R
      RF(I,41)=RF(I,41)*R
      RF(I,42)=RF(I,42)*R
      RF(I,43)=RF(I,43)*R
      RB(I,44)=RB(I,44)*R
      RB(I,46)=RB(I,46)*R
      RB(I,55)=RB(I,55)*R
      RB(I,56)=RB(I,56)*R
      RB(I,58)=RB(I,58)*R
      RB(I,59)=RB(I,59)*R
      RB(I,60)=RB(I,60)*R
      RB(I,61)=RB(I,61)*R
      RB(I,62)=RB(I,62)*R
      RB(I,63)=RB(I,63)*R
      RB(I,63)=RB(I,63)*R
      RB(I,64)=RB(I,64)*R
      RB(I,66)=RB(I,66)*R
      RB(I,67)=RB(I,67)*R
      RB(I,68)=RB(I,68)*R
      RB(I,69)=RB(I,69)*R
      RB(I,70)=RB(I,70)*R
      RB(I,88)=RB(I,88)*R
      RB(I,107)=RB(I,107)*R
      RB(I,114)=RB(I,114)*R
      RB(I,117)=RB(I,117)*R
      RB(I,125)=RB(I,125)*R
      RB(I,129)=RB(I,129)*R
      RB(I,138)=RB(I,138)*R
      RB(I,139)=RB(I,139)*R
      RF(I,140)=RF(I,140)*R
      RB(I,154)=RB(I,154)*R
      RB(I,157)=RB(I,157)*R
      RB(I,157)=RB(I,157)*R
      RF(I,165)=RF(I,165)*R
      ENDIF
C
C     C2H6
      DDOT=+RB(I,48)+RF(I,80)+RF(I,81)+RF(I,82)+RF(I,83)+RF(I,84)
     *+RF(I,85)+RB(I,86)+RB(I,90)+RB(I,91)
      TINV=DDOT/C(I,13)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,48)+RB(I,80)+RB(I,81)+RB(I,82)+RB(I,83)+RB(I,84)
     *+RB(I,85)+RF(I,86)+RF(I,90)+RF(I,91)
      C0=C(I,13)*(CDOT+DIFF(I,13)/30.07012057)/DDOT
      C0=C(I,13)*(CDOT+DIFF(I,13)/30.07012057+(C(I,13)-C0)/DT)/DDOT
      R=C0/C(I,13)
      RB(I,48)=RB(I,48)*R
      RF(I,80)=RF(I,80)*R
      RF(I,81)=RF(I,81)*R
      RF(I,82)=RF(I,82)*R
      RF(I,83)=RF(I,83)*R
      RF(I,84)=RF(I,84)*R
      RF(I,85)=RF(I,85)*R
      RB(I,86)=RB(I,86)*R
      RB(I,90)=RB(I,90)*R
      RB(I,91)=RB(I,91)*R
      ENDIF
C
C     CH3O
      DDOT=+RB(I,45)+RB(I,47)+RF(I,64)+RF(I,65)+RF(I,66)+RF(I,67)
     *+RF(I,68)+RF(I,69)+RF(I,70)+RF(I,71)+RF(I,79)+RB(I,131)+RF(I,139)
     *+RB(I,149)+RB(I,154)
      TINV=DDOT/C(I,14)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,45)+RF(I,47)+RB(I,64)+RB(I,65)+RB(I,66)+RB(I,67)
     *+RB(I,68)+RB(I,69)+RB(I,70)+RB(I,71)+RB(I,79)+RF(I,131)+RB(I,139)
     *+RF(I,149)+RF(I,154)
      C0=C(I,14)*(CDOT+DIFF(I,14)/31.03446043)/DDOT
      C0=C(I,14)*(CDOT+DIFF(I,14)/31.03446043+(C(I,14)-C0)/DT)/DDOT
      R=C0/C(I,14)
      RB(I,45)=RB(I,45)*R
      RB(I,47)=RB(I,47)*R
      RF(I,64)=RF(I,64)*R
      RF(I,65)=RF(I,65)*R
      RF(I,66)=RF(I,66)*R
      RF(I,67)=RF(I,67)*R
      RF(I,68)=RF(I,68)*R
      RF(I,69)=RF(I,69)*R
      RF(I,70)=RF(I,70)*R
      RF(I,71)=RF(I,71)*R
      RF(I,79)=RF(I,79)*R
      RB(I,131)=RB(I,131)*R
      RF(I,139)=RF(I,139)*R
      RB(I,149)=RB(I,149)*R
      RB(I,154)=RB(I,154)*R
      ENDIF
C
C     HO2
      DDOT=+RB(I,9)+RF(I,10)+RF(I,11)+RF(I,12)+RF(I,13)+RF(I,14)
     *+RF(I,14)+RF(I,15)+RF(I,15)+RB(I,18)+RB(I,19)+RB(I,20)+RB(I,21)
     *+RF(I,24)+RB(I,27)+RF(I,32)+RB(I,41)+RF(I,42)+RF(I,47)+RF(I,53)
     *+RF(I,54)+RB(I,60)+RB(I,61)+RF(I,62)+RB(I,68)+RB(I,69)+RF(I,70)
     *+RB(I,83)+RF(I,84)+RB(I,89)+RB(I,102)+RB(I,104)+RB(I,108)
     *+RF(I,117)+RF(I,136)+RB(I,137)+RF(I,141)+RB(I,143)+RF(I,145)
     *+RB(I,155)+RF(I,174)
      TINV=DDOT/C(I,16)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,9)+RB(I,10)+RB(I,11)+RB(I,12)+RB(I,13)+RB(I,14)
     *+RB(I,14)+RB(I,15)+RB(I,15)+RF(I,18)+RF(I,19)+RF(I,20)+RF(I,21)
     *+RB(I,24)+RF(I,27)+RB(I,32)+RF(I,41)+RB(I,42)+RB(I,47)+RB(I,53)
     *+RB(I,54)+RF(I,60)+RF(I,61)+RB(I,62)+RF(I,68)+RF(I,69)+RB(I,70)
     *+RF(I,83)+RB(I,84)+RF(I,89)+RF(I,102)+RF(I,104)+RF(I,108)
     *+RB(I,117)+RB(I,136)+RF(I,137)+RB(I,141)+RF(I,143)+RB(I,145)
     *+RF(I,155)+RB(I,174)
      C0=C(I,16)*(CDOT+DIFF(I,16)/33.00677025)/DDOT
      C0=C(I,16)*(CDOT+DIFF(I,16)/33.00677025+(C(I,16)-C0)/DT)/DDOT
      R=C0/C(I,16)
      RB(I,9)=RB(I,9)*R
      RF(I,10)=RF(I,10)*R
      RF(I,11)=RF(I,11)*R
      RF(I,12)=RF(I,12)*R
      RF(I,13)=RF(I,13)*R
      RF(I,14)=RF(I,14)*R
      RF(I,14)=RF(I,14)*R
      RF(I,15)=RF(I,15)*R
      RF(I,15)=RF(I,15)*R
      RB(I,18)=RB(I,18)*R
      RB(I,19)=RB(I,19)*R
      RB(I,20)=RB(I,20)*R
      RB(I,21)=RB(I,21)*R
      RF(I,24)=RF(I,24)*R
      RB(I,27)=RB(I,27)*R
      RF(I,32)=RF(I,32)*R
      RB(I,41)=RB(I,41)*R
      RF(I,42)=RF(I,42)*R
      RF(I,47)=RF(I,47)*R
      RF(I,53)=RF(I,53)*R
      RF(I,54)=RF(I,54)*R
      RB(I,60)=RB(I,60)*R
      RB(I,61)=RB(I,61)*R
      RF(I,62)=RF(I,62)*R
      RB(I,68)=RB(I,68)*R
      RB(I,69)=RB(I,69)*R
      RF(I,70)=RF(I,70)*R
      RB(I,83)=RB(I,83)*R
      RF(I,84)=RF(I,84)*R
      RB(I,89)=RB(I,89)*R
      RB(I,102)=RB(I,102)*R
      RB(I,104)=RB(I,104)*R
      RB(I,108)=RB(I,108)*R
      RF(I,117)=RF(I,117)*R
      RF(I,136)=RF(I,136)*R
      RB(I,137)=RB(I,137)*R
      RF(I,141)=RF(I,141)*R
      RB(I,143)=RB(I,143)*R
      RF(I,145)=RF(I,145)*R
      RB(I,155)=RB(I,155)*R
      RF(I,174)=RF(I,174)*R
      ENDIF
C
C     H2O2
      DDOT=+RB(I,14)+RB(I,15)+RF(I,16)+RF(I,17)+RF(I,18)+RF(I,19)
     *+RF(I,20)+RF(I,21)+RB(I,42)+RB(I,54)+RB(I,62)+RB(I,70)+RB(I,84)
     *+RF(I,104)+RB(I,136)+RB(I,145)+RB(I,174)
      TINV=DDOT/C(I,17)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,14)+RF(I,15)+RB(I,16)+RB(I,17)+RB(I,18)+RB(I,19)
     *+RB(I,20)+RB(I,21)+RF(I,42)+RF(I,54)+RF(I,62)+RF(I,70)+RF(I,84)
     *+RB(I,104)+RF(I,136)+RF(I,145)+RF(I,174)
      C0=C(I,17)*(CDOT+DIFF(I,17)/34.01474023)/DDOT
      C0=C(I,17)*(CDOT+DIFF(I,17)/34.01474023+(C(I,17)-C0)/DT)/DDOT
      R=C0/C(I,17)
      RB(I,14)=RB(I,14)*R
      RB(I,15)=RB(I,15)*R
      RF(I,16)=RF(I,16)*R
      RF(I,17)=RF(I,17)*R
      RF(I,18)=RF(I,18)*R
      RF(I,19)=RF(I,19)*R
      RF(I,20)=RF(I,20)*R
      RF(I,21)=RF(I,21)*R
      RB(I,42)=RB(I,42)*R
      RB(I,54)=RB(I,54)*R
      RB(I,62)=RB(I,62)*R
      RB(I,70)=RB(I,70)*R
      RB(I,84)=RB(I,84)*R
      RF(I,104)=RF(I,104)*R
      RB(I,136)=RB(I,136)*R
      RB(I,145)=RB(I,145)*R
      RB(I,174)=RB(I,174)*R
      ENDIF
C
C     CH3HCO
      DDOT=+RB(I,92)+RF(I,130)
      TINV=DDOT/C(I,19)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,92)+RB(I,130)
      C0=C(I,19)*(CDOT+DIFF(I,19)/44.05358076)/DDOT
      C0=C(I,19)*(CDOT+DIFF(I,19)/44.05358076+(C(I,19)-C0)/DT)/DDOT
      R=C0/C(I,19)
      RB(I,92)=RB(I,92)*R
      RF(I,130)=RF(I,130)*R
      ENDIF
C
C     HCOOH
      DDOT=+RB(I,164)+RF(I,166)+RF(I,167)+RF(I,168)+RF(I,169)+RF(I,170)
     *+RF(I,171)+RF(I,172)+RF(I,173)+RF(I,174)+RF(I,175)
      TINV=DDOT/C(I,20)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,164)+RB(I,166)+RB(I,167)+RB(I,168)+RB(I,169)+RB(I,170)
     *+RB(I,171)+RB(I,172)+RB(I,173)+RB(I,174)+RB(I,175)
      C0=C(I,20)*(CDOT+DIFF(I,20)/46.02589059)/DDOT
      C0=C(I,20)*(CDOT+DIFF(I,20)/46.02589059+(C(I,20)-C0)/DT)/DDOT
      R=C0/C(I,20)
      RB(I,164)=RB(I,164)*R
      RF(I,166)=RF(I,166)*R
      RF(I,167)=RF(I,167)*R
      RF(I,168)=RF(I,168)*R
      RF(I,169)=RF(I,169)*R
      RF(I,170)=RF(I,170)*R
      RF(I,171)=RF(I,171)*R
      RF(I,172)=RF(I,172)*R
      RF(I,173)=RF(I,173)*R
      RF(I,174)=RF(I,174)*R
      RF(I,175)=RF(I,175)*R
      ENDIF
C
C     CH3OCH3
      DDOT=+RF(I,131)+RF(I,132)+RF(I,133)+RF(I,134)+RF(I,135)+RF(I,136)
     *+RF(I,137)+RB(I,139)+RB(I,140)
      TINV=DDOT/C(I,21)
      IF (TINV .GT. TC) THEN
      CDOT=+RB(I,131)+RB(I,132)+RB(I,133)+RB(I,134)+RB(I,135)+RB(I,136)
     *+RB(I,137)+RF(I,139)+RF(I,140)
      C0=C(I,21)*(CDOT+DIFF(I,21)/46.06952071)/DDOT
      C0=C(I,21)*(CDOT+DIFF(I,21)/46.06952071+(C(I,21)-C0)/DT)/DDOT
      R=C0/C(I,21)
      RF(I,131)=RF(I,131)*R
      RF(I,132)=RF(I,132)*R
      RF(I,133)=RF(I,133)*R
      RF(I,134)=RF(I,134)*R
      RF(I,135)=RF(I,135)*R
      RF(I,136)=RF(I,136)*R
      RF(I,137)=RF(I,137)*R
      RB(I,139)=RB(I,139)*R
      RB(I,140)=RB(I,140)*R
      ENDIF
C
C     CH3OCHO
      DDOT=+RB(I,142)+RF(I,143)+RF(I,144)+RF(I,145)+RF(I,146)+RF(I,147)
     *+RF(I,148)+RB(I,153)+RB(I,155)
      TINV=DDOT/C(I,23)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,142)+RB(I,143)+RB(I,144)+RB(I,145)+RB(I,146)+RB(I,147)
     *+RB(I,148)+RF(I,153)+RF(I,155)
      C0=C(I,23)*(CDOT+DIFF(I,23)/60.05298090)/DDOT
      C0=C(I,23)*(CDOT+DIFF(I,23)/60.05298090+(C(I,23)-C0)/DT)/DDOT
      R=C0/C(I,23)
      RB(I,142)=RB(I,142)*R
      RF(I,143)=RF(I,143)*R
      RF(I,144)=RF(I,144)*R
      RF(I,145)=RF(I,145)*R
      RF(I,146)=RF(I,146)*R
      RF(I,147)=RF(I,147)*R
      RF(I,148)=RF(I,148)*R
      RB(I,153)=RB(I,153)*R
      RB(I,155)=RB(I,155)*R
      ENDIF
C
C     OCH2OCHO
      DDOT=+RB(I,160)+RF(I,161)
      TINV=DDOT/C(I,25)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,160)+RB(I,161)
      C0=C(I,25)*(CDOT+DIFF(I,25)/75.04441106)/DDOT
      C0=C(I,25)*(CDOT+DIFF(I,25)/75.04441106+(C(I,25)-C0)/DT)/DDOT
      R=C0/C(I,25)
      RB(I,160)=RB(I,160)*R
      RF(I,161)=RF(I,161)*R
      ENDIF
C
C     HOCH2OCO
      DDOT=+RB(I,161)+RF(I,162)+RF(I,163)
      TINV=DDOT/C(I,26)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,161)+RB(I,162)+RB(I,163)
      C0=C(I,26)*(CDOT+DIFF(I,26)/75.04441106)/DDOT
      C0=C(I,26)*(CDOT+DIFF(I,26)/75.04441106+(C(I,26)-C0)/DT)/DDOT
      R=C0/C(I,26)
      RB(I,161)=RB(I,161)*R
      RF(I,162)=RF(I,162)*R
      RF(I,163)=RF(I,163)*R
      ENDIF
C
C     CH3OCH2O2
      DDOT=+RB(I,151)+RF(I,152)+RF(I,152)+RF(I,153)+RF(I,153)+RF(I,156)
      TINV=DDOT/C(I,27)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,151)+RB(I,152)+RB(I,152)+RB(I,153)+RB(I,153)+RB(I,156)
      C0=C(I,27)*(CDOT+DIFF(I,27)/77.06035101)/DDOT
      C0=C(I,27)*(CDOT+DIFF(I,27)/77.06035101+(C(I,27)-C0)/DT)/DDOT
      R=C0/C(I,27)
      RB(I,151)=RB(I,151)*R
      RF(I,152)=RF(I,152)*R
      RF(I,152)=RF(I,152)*R
      RF(I,153)=RF(I,153)*R
      RF(I,153)=RF(I,153)*R
      RF(I,156)=RF(I,156)*R
      ENDIF
C
C     HO2CH2OCHO
      DDOT=+RB(I,159)+RF(I,160)
      TINV=DDOT/C(I,28)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,159)+RB(I,160)
      C0=C(I,28)*(CDOT+DIFF(I,28)/92.05178118)/DDOT
      C0=C(I,28)*(CDOT+DIFF(I,28)/92.05178118+(C(I,28)-C0)/DT)/DDOT
      R=C0/C(I,28)
      RB(I,159)=RB(I,159)*R
      RF(I,160)=RF(I,160)*R
      ENDIF
C
C     O2CH2OCH2O2H
      DDOT=+RB(I,158)+RF(I,159)
      TINV=DDOT/C(I,29)
      IF (TINV .GT. TC) THEN
      CDOT=+RF(I,158)+RB(I,159)
      C0=C(I,29)*(CDOT+DIFF(I,29)/109.05915129)/DDOT
      C0=C(I,29)*(CDOT+DIFF(I,29)/109.05915129+(C(I,29)-C0)/DT)/DDOT
      R=C0/C(I,29)
      RB(I,158)=RB(I,158)*R
      RF(I,159)=RF(I,159)*R
      ENDIF
C
      ENDDO
      END
