C                                                                      C
C----------------------------------------------------------------------C
C                                                                      C
      SUBROUTINE QSSA(VL, RF, RB, XQ)
      USE chemkin_m, only : MAXVL
      IMPLICIT DOUBLE PRECISION (A-H, O-Z), INTEGER (I-N)
      DIMENSION RF(MAXVL,*),RB(MAXVL,*),XQ(MAXVL,*)
      DIMENSION DEN(MAXVL)
      DIMENSION A1_0(MAXVL)
      DIMENSION A1_2(MAXVL)
      DIMENSION A1_4(MAXVL)
      DIMENSION A2_0(MAXVL)
      DIMENSION A2_1(MAXVL)
      DIMENSION A2_4(MAXVL)
      DIMENSION A3_0(MAXVL)
      DIMENSION A3_4(MAXVL)
      DIMENSION A4_0(MAXVL)
      DIMENSION A4_1(MAXVL)
      DIMENSION A4_2(MAXVL)
      DIMENSION A4_3(MAXVL)
      DIMENSION A4_6(MAXVL)
      DIMENSION A5_0(MAXVL)
      DIMENSION A6_0(MAXVL)
      DIMENSION A6_4(MAXVL)
      DIMENSION A6_8(MAXVL)
      DIMENSION A7_0(MAXVL)
      DIMENSION A8_0(MAXVL)
      DIMENSION A8_6(MAXVL)
      DIMENSION A9_0(MAXVL)
        INTEGER VL
      PARAMETER (SMALL = 1.D-50)
C
      RF(:VL,33) = 0D0
      RF(:VL,35) = 0D0
      RF(:VL,63) = 0D0
      RF(:VL,106) = 0D0
      RF(:VL,118) = 0D0
      RB(:VL,152) = 0D0
C
C     CH2
      DEN(:VL) = +RF(:VL,73) +RF(:VL,77) +RF(:VL,112) 
     *  +RF(:VL,113) +RF(:VL,114) +RF(:VL,115) +RF(:VL,116) 
     *  +RF(:VL,117) +RB(:VL,75) +RB(:VL,110) +RB(:VL,119) 
     *  +RB(:VL,120) +RB(:VL,121) +RB(:VL,122) 
      A1_0(:VL) = ( +RB(:VL,73) +RF(:VL,75) +RB(:VL,77) 
     *  +RF(:VL,110) +RB(:VL,112) +RB(:VL,114) +RB(:VL,115) 
     *  +RB(:VL,117) +RB(:VL,118) +RB(:VL,118) )
     *      /MAX(DEN(:VL), SMALL)
      A1_2(:VL) = ( +RF(:VL,119) +RF(:VL,120) +RF(:VL,121) 
     *  +RF(:VL,122) )
     *      /MAX(DEN(:VL), SMALL)
      A1_4(:VL) = ( +RB(:VL,113) +RB(:VL,116) )
     *      /MAX(DEN(:VL), SMALL)
C     CH2(S)
      DEN(:VL) = +RF(:VL,74) +RF(:VL,78) +RF(:VL,119) 
     *  +RF(:VL,120) +RF(:VL,121) +RF(:VL,122) +RF(:VL,123) 
     *  +RF(:VL,124) +RF(:VL,125) +RF(:VL,126) +RF(:VL,127) 
     *  +RF(:VL,128) +RF(:VL,129) +RB(:VL,76) +RB(:VL,79) 
      A2_0(:VL) = ( +RB(:VL,74) +RF(:VL,76) +RB(:VL,78) 
     *  +RF(:VL,79) +RB(:VL,123) +RB(:VL,125) +RB(:VL,126) 
     *  +RB(:VL,127) +RB(:VL,128) +RB(:VL,129) )
     *      /MAX(DEN(:VL), SMALL)
      A2_1(:VL) = ( +RB(:VL,119) +RB(:VL,120) +RB(:VL,121) 
     *  +RB(:VL,122) )
     *      /MAX(DEN(:VL), SMALL)
      A2_4(:VL) = ( +RB(:VL,124) )
     *      /MAX(DEN(:VL), SMALL)
C     C2H3
      DEN(:VL) = +RF(:VL,95) +RF(:VL,100) +RF(:VL,103) 
     *  +RF(:VL,104) +RF(:VL,105) +RF(:VL,107) +RF(:VL,108) 
     *  +RB(:VL,96) +RB(:VL,97) +RB(:VL,98) +RB(:VL,101) 
     *  +RB(:VL,102) +RB(:VL,109) 
      A3_0(:VL) = ( +RB(:VL,95) +RF(:VL,96) +RF(:VL,97) 
     *  +RF(:VL,98) +RB(:VL,100) +RF(:VL,101) +RF(:VL,102) 
     *  +RB(:VL,103) +RB(:VL,104) +RB(:VL,105) +RB(:VL,106) 
     *  +RB(:VL,106) +RB(:VL,108) +RF(:VL,109) )
     *      /MAX(DEN(:VL), SMALL)
      A3_4(:VL) = ( +RB(:VL,107) )
     *      /MAX(DEN(:VL), SMALL)
C     HCO
      DEN(:VL) = +RF(:VL,26) +RF(:VL,27) +RF(:VL,28) 
     *  +RF(:VL,29) +RF(:VL,30) +RF(:VL,31) +RF(:VL,32) 
     *  +RF(:VL,34) +RF(:VL,91) +RB(:VL,36) +RB(:VL,38) 
     *  +RB(:VL,39) +RB(:VL,40) +RB(:VL,41) +RB(:VL,42) 
     *  +RB(:VL,43) +RB(:VL,99) +RB(:VL,107) +RB(:VL,113) 
     *  +RB(:VL,116) +RB(:VL,124) +RB(:VL,130) +RB(:VL,140) 
     *  +RB(:VL,168) 
      A4_0(:VL) = ( +RB(:VL,26) +RB(:VL,27) +RB(:VL,28) 
     *  +RB(:VL,29) +RB(:VL,30) +RB(:VL,31) +RB(:VL,32) 
     *  +RB(:VL,33) +RB(:VL,33) +RB(:VL,34) +RB(:VL,35) 
     *  +RB(:VL,35) +RF(:VL,36) +RF(:VL,38) +RF(:VL,39) 
     *  +RF(:VL,40) +RF(:VL,41) +RF(:VL,42) +RF(:VL,43) 
     *  +RB(:VL,63) +RB(:VL,91) +RF(:VL,99) +RF(:VL,130) 
     *  +RF(:VL,168) )
     *      /MAX(DEN(:VL), SMALL)
      A4_1(:VL) = ( +RF(:VL,113) +RF(:VL,116) )
     *      /MAX(DEN(:VL), SMALL)
      A4_2(:VL) = ( +RF(:VL,124) )
     *      /MAX(DEN(:VL), SMALL)
      A4_3(:VL) = ( +RF(:VL,107) )
     *      /MAX(DEN(:VL), SMALL)
      A4_6(:VL) = ( +RF(:VL,140) )
     *      /MAX(DEN(:VL), SMALL)
C     CH2OH
      DEN(:VL) = +RF(:VL,55) +RF(:VL,56) +RF(:VL,57) 
     *  +RF(:VL,58) +RF(:VL,59) +RF(:VL,60) +RF(:VL,61) 
     *  +RF(:VL,62) +RB(:VL,163) 
      A5_0(:VL) = ( +RB(:VL,55) +RB(:VL,56) +RB(:VL,57) 
     *  +RB(:VL,58) +RB(:VL,59) +RB(:VL,60) +RB(:VL,61) 
     *  +RB(:VL,62) +RB(:VL,63) +RF(:VL,163) )
     *      /MAX(DEN(:VL), SMALL)
C     CH3OCH2
      DEN(:VL) = +RF(:VL,138) +RF(:VL,139) +RF(:VL,140) 
     *  +RF(:VL,141) +RF(:VL,151) +RB(:VL,132) +RB(:VL,133) 
     *  +RB(:VL,134) +RB(:VL,135) +RB(:VL,136) +RB(:VL,137) 
      A6_0(:VL) = ( +RF(:VL,132) +RF(:VL,133) +RF(:VL,134) 
     *  +RF(:VL,135) +RF(:VL,136) +RF(:VL,137) +RB(:VL,138) 
     *  +RB(:VL,139) +RB(:VL,151) )
     *      /MAX(DEN(:VL), SMALL)
      A6_4(:VL) = ( +RB(:VL,140) )
     *      /MAX(DEN(:VL), SMALL)
      A6_8(:VL) = ( +RB(:VL,141) )
     *      /MAX(DEN(:VL), SMALL)
C     HOCH2O
      DEN(:VL) = +RF(:VL,164) +RB(:VL,162) +RB(:VL,165) 
      A7_0(:VL) = ( +RF(:VL,162) +RB(:VL,164) +RF(:VL,165) )
     *      /MAX(DEN(:VL), SMALL)
C     CH3OCH2O
      DEN(:VL) = +RF(:VL,142) +RF(:VL,154) +RF(:VL,155) 
     *  +RB(:VL,141) 
      A8_0(:VL) = ( +RB(:VL,142) +RF(:VL,152) +RF(:VL,152) 
     *  +RB(:VL,154) +RB(:VL,155) )
     *      /MAX(DEN(:VL), SMALL)
      A8_6(:VL) = ( +RF(:VL,141) )
     *      /MAX(DEN(:VL), SMALL)
C     CH2OCH2O2H
      DEN(:VL) = +RF(:VL,157) +RF(:VL,158) +RB(:VL,156) 
      A9_0(:VL) = ( +RF(:VL,156) +RB(:VL,157) +RB(:VL,158) )
     *      /MAX(DEN(:VL), SMALL)
C
      A6_0(:VL) = A6_0(:VL) + A6_8(:VL)*A8_0(:VL)
      DEN(:VL) = 1D0 -A6_8(:VL)*A8_6(:VL)
      A6_0(:VL) = A6_0(:VL)/MAX(DEN(:VL), SMALL)
      A6_4(:VL) = A6_4(:VL)/MAX(DEN(:VL), SMALL)
      A4_0(:VL) = A4_0(:VL) + A4_3(:VL)*A3_0(:VL)
      DEN(:VL) = 1D0 -A4_3(:VL)*A3_4(:VL)
      A4_0(:VL) = A4_0(:VL)/MAX(DEN(:VL), SMALL)
      A4_1(:VL) = A4_1(:VL)/MAX(DEN(:VL), SMALL)
      A4_6(:VL) = A4_6(:VL)/MAX(DEN(:VL), SMALL)
      A4_2(:VL) = A4_2(:VL)/MAX(DEN(:VL), SMALL)
      A4_0(:VL) = A4_0(:VL) + A4_2(:VL)*A2_0(:VL)
      A4_1(:VL) = A4_1(:VL) + A4_2(:VL)*A2_1(:VL)
      DEN(:VL) = 1D0 -A4_2(:VL)*A2_4(:VL)
      A4_0(:VL) = A4_0(:VL)/MAX(DEN(:VL), SMALL)
      A4_1(:VL) = A4_1(:VL)/MAX(DEN(:VL), SMALL)
      A4_6(:VL) = A4_6(:VL)/MAX(DEN(:VL), SMALL)
      A1_0(:VL) = A1_0(:VL) + A1_2(:VL)*A2_0(:VL)
      A1_4(:VL) = A1_4(:VL) + A1_2(:VL)*A2_4(:VL)
      DEN(:VL) = 1D0 -A1_2(:VL)*A2_1(:VL)
      A1_0(:VL) = A1_0(:VL)/MAX(DEN(:VL), SMALL)
      A1_4(:VL) = A1_4(:VL)/MAX(DEN(:VL), SMALL)
      A4_0(:VL) = A4_0(:VL) + A4_6(:VL)*A6_0(:VL)
      DEN(:VL) = 1D0 -A4_6(:VL)*A6_4(:VL)
      A4_0(:VL) = A4_0(:VL)/MAX(DEN(:VL), SMALL)
      A4_1(:VL) = A4_1(:VL)/MAX(DEN(:VL), SMALL)
      A4_0(:VL) = A4_0(:VL) + A4_1(:VL)*A1_0(:VL)
      DEN(:VL) = 1D0 -A4_1(:VL)*A1_4(:VL)
      A4_0(:VL) = A4_0(:VL)/MAX(DEN(:VL), SMALL)
      XQ(:VL,4) = A4_0(:VL)
      XQ(:VL,1) = A1_0(:VL) 
     *      +A1_4(:VL)*XQ(:VL,4)
      XQ(:VL,6) = A6_0(:VL) 
     *      +A6_4(:VL)*XQ(:VL,4)
      XQ(:VL,2) = A2_0(:VL) 
     *      +A2_4(:VL)*XQ(:VL,4) 
     *      +A2_1(:VL)*XQ(:VL,1)
      XQ(:VL,3) = A3_0(:VL) 
     *      +A3_4(:VL)*XQ(:VL,4)
      XQ(:VL,8) = A8_0(:VL) 
     *      +A8_6(:VL)*XQ(:VL,6)
      XQ(:VL,5) = A5_0(:VL)
      XQ(:VL,7) = A7_0(:VL)
      XQ(:VL,9) = A9_0(:VL)
C
      RF(:VL,26) = RF(:VL,26)*XQ(:VL,4)
      RF(:VL,27) = RF(:VL,27)*XQ(:VL,4)
      RF(:VL,28) = RF(:VL,28)*XQ(:VL,4)
      RF(:VL,29) = RF(:VL,29)*XQ(:VL,4)
      RF(:VL,30) = RF(:VL,30)*XQ(:VL,4)
      RF(:VL,31) = RF(:VL,31)*XQ(:VL,4)
      RF(:VL,32) = RF(:VL,32)*XQ(:VL,4)
      RF(:VL,34) = RF(:VL,34)*XQ(:VL,4)
      RB(:VL,36) = RB(:VL,36)*XQ(:VL,4)
      RB(:VL,38) = RB(:VL,38)*XQ(:VL,4)
      RB(:VL,39) = RB(:VL,39)*XQ(:VL,4)
      RB(:VL,40) = RB(:VL,40)*XQ(:VL,4)
      RB(:VL,41) = RB(:VL,41)*XQ(:VL,4)
      RB(:VL,42) = RB(:VL,42)*XQ(:VL,4)
      RB(:VL,43) = RB(:VL,43)*XQ(:VL,4)
      RF(:VL,55) = RF(:VL,55)*XQ(:VL,5)
      RF(:VL,56) = RF(:VL,56)*XQ(:VL,5)
      RF(:VL,57) = RF(:VL,57)*XQ(:VL,5)
      RF(:VL,58) = RF(:VL,58)*XQ(:VL,5)
      RF(:VL,59) = RF(:VL,59)*XQ(:VL,5)
      RF(:VL,60) = RF(:VL,60)*XQ(:VL,5)
      RF(:VL,61) = RF(:VL,61)*XQ(:VL,5)
      RF(:VL,62) = RF(:VL,62)*XQ(:VL,5)
      RF(:VL,73) = RF(:VL,73)*XQ(:VL,1)
      RF(:VL,74) = RF(:VL,74)*XQ(:VL,2)
      RB(:VL,75) = RB(:VL,75)*XQ(:VL,1)
      RB(:VL,76) = RB(:VL,76)*XQ(:VL,2)
      RF(:VL,77) = RF(:VL,77)*XQ(:VL,1)
      RF(:VL,78) = RF(:VL,78)*XQ(:VL,2)
      RB(:VL,79) = RB(:VL,79)*XQ(:VL,2)
      RF(:VL,91) = RF(:VL,91)*XQ(:VL,4)
      RF(:VL,95) = RF(:VL,95)*XQ(:VL,3)
      RB(:VL,96) = RB(:VL,96)*XQ(:VL,3)
      RB(:VL,97) = RB(:VL,97)*XQ(:VL,3)
      RB(:VL,98) = RB(:VL,98)*XQ(:VL,3)
      RB(:VL,99) = RB(:VL,99)*XQ(:VL,4)
      RF(:VL,100) = RF(:VL,100)*XQ(:VL,3)
      RB(:VL,101) = RB(:VL,101)*XQ(:VL,3)
      RB(:VL,102) = RB(:VL,102)*XQ(:VL,3)
      RF(:VL,103) = RF(:VL,103)*XQ(:VL,3)
      RF(:VL,104) = RF(:VL,104)*XQ(:VL,3)
      RF(:VL,105) = RF(:VL,105)*XQ(:VL,3)
      RF(:VL,107) = RF(:VL,107)*XQ(:VL,3)
      RB(:VL,107) = RB(:VL,107)*XQ(:VL,4)
      RF(:VL,108) = RF(:VL,108)*XQ(:VL,3)
      RB(:VL,109) = RB(:VL,109)*XQ(:VL,3)
      RB(:VL,110) = RB(:VL,110)*XQ(:VL,1)
      RF(:VL,112) = RF(:VL,112)*XQ(:VL,1)
      RF(:VL,113) = RF(:VL,113)*XQ(:VL,1)
      RB(:VL,113) = RB(:VL,113)*XQ(:VL,4)
      RF(:VL,114) = RF(:VL,114)*XQ(:VL,1)
      RF(:VL,115) = RF(:VL,115)*XQ(:VL,1)
      RF(:VL,116) = RF(:VL,116)*XQ(:VL,1)
      RB(:VL,116) = RB(:VL,116)*XQ(:VL,4)
      RF(:VL,117) = RF(:VL,117)*XQ(:VL,1)
      RF(:VL,119) = RF(:VL,119)*XQ(:VL,2)
      RB(:VL,119) = RB(:VL,119)*XQ(:VL,1)
      RF(:VL,120) = RF(:VL,120)*XQ(:VL,2)
      RB(:VL,120) = RB(:VL,120)*XQ(:VL,1)
      RF(:VL,121) = RF(:VL,121)*XQ(:VL,2)
      RB(:VL,121) = RB(:VL,121)*XQ(:VL,1)
      RF(:VL,122) = RF(:VL,122)*XQ(:VL,2)
      RB(:VL,122) = RB(:VL,122)*XQ(:VL,1)
      RF(:VL,123) = RF(:VL,123)*XQ(:VL,2)
      RF(:VL,124) = RF(:VL,124)*XQ(:VL,2)
      RB(:VL,124) = RB(:VL,124)*XQ(:VL,4)
      RF(:VL,125) = RF(:VL,125)*XQ(:VL,2)
      RF(:VL,126) = RF(:VL,126)*XQ(:VL,2)
      RF(:VL,127) = RF(:VL,127)*XQ(:VL,2)
      RF(:VL,128) = RF(:VL,128)*XQ(:VL,2)
      RF(:VL,129) = RF(:VL,129)*XQ(:VL,2)
      RB(:VL,130) = RB(:VL,130)*XQ(:VL,4)
      RB(:VL,132) = RB(:VL,132)*XQ(:VL,6)
      RB(:VL,133) = RB(:VL,133)*XQ(:VL,6)
      RB(:VL,134) = RB(:VL,134)*XQ(:VL,6)
      RB(:VL,135) = RB(:VL,135)*XQ(:VL,6)
      RB(:VL,136) = RB(:VL,136)*XQ(:VL,6)
      RB(:VL,137) = RB(:VL,137)*XQ(:VL,6)
      RF(:VL,138) = RF(:VL,138)*XQ(:VL,6)
      RF(:VL,139) = RF(:VL,139)*XQ(:VL,6)
      RF(:VL,140) = RF(:VL,140)*XQ(:VL,6)
      RB(:VL,140) = RB(:VL,140)*XQ(:VL,4)
      RF(:VL,141) = RF(:VL,141)*XQ(:VL,6)
      RB(:VL,141) = RB(:VL,141)*XQ(:VL,8)
      RF(:VL,142) = RF(:VL,142)*XQ(:VL,8)
      RF(:VL,151) = RF(:VL,151)*XQ(:VL,6)
      RF(:VL,154) = RF(:VL,154)*XQ(:VL,8)
      RF(:VL,155) = RF(:VL,155)*XQ(:VL,8)
      RB(:VL,156) = RB(:VL,156)*XQ(:VL,9)
      RF(:VL,157) = RF(:VL,157)*XQ(:VL,9)
      RF(:VL,158) = RF(:VL,158)*XQ(:VL,9)
      RB(:VL,162) = RB(:VL,162)*XQ(:VL,7)
      RB(:VL,163) = RB(:VL,163)*XQ(:VL,5)
      RF(:VL,164) = RF(:VL,164)*XQ(:VL,7)
      RB(:VL,165) = RB(:VL,165)*XQ(:VL,7)
      RB(:VL,168) = RB(:VL,168)*XQ(:VL,4)
C
      END
